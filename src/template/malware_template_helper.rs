use super::helpers;

/// Render a section describing Conficker malware infections.
pub fn conficker_section(hosts: &[&str]) -> String {
    if hosts.is_empty() {
        "No Conficker infections detected.".to_string()
    } else {
        let mut lines = Vec::new();
        lines.push(helpers::heading2("Conficker Infections"));
        for h in hosts {
            lines.push(format!("- {h}"));
        }
        lines.join("\n")
    }
}

#[cfg(test)]
mod tests {
    use super::*;

    #[test]
    fn no_infections() {
        assert_eq!(conficker_section(&[]), "No Conficker infections detected.");
    }

    #[test]
    fn list_infections() {
        let out = conficker_section(&["h1", "h2"]);
        assert!(out.contains("Conficker Infections"));
        assert!(out.contains("h1"));
        assert!(out.contains("h2"));
    }
}
